---
- block:
    - name: Create custom SSM document
      community.aws.ssm_document:
        state: present
        document_type: Session
        content_path: "{{ role_path }}/files/ssm-document.json"
        name: "{{ ssm_document_name }}"
  always:
    - name: Create SSM vars_to_delete.yml
      template:
        dest: "{{ playbook_dir }}/ssm_vars_to_delete.yml"
        src: ssm_vars_to_delete.yml.j2
      ignore_errors: true
